<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>Iowa Rural Justice: Attorneys by Zip Code</title>
  <link rel="icon" type="image/jpg" href="images/icon.jpg" />
  <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.10.2/css/all.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.10.2/css/v4-shims.css">


  <link href='https://api.mapbox.com/mapbox-assembly/v0.8.0/assembly.min.css' rel='stylesheet'>
  <link href='https://api.mapbox.com/mapbox.js/v3.2.1/mapbox.css' rel='stylesheet' />
  <link href="https://fonts.googleapis.com/css?family=Rubik&display=swap" rel="stylesheet">

  <!--leaflet tag filter buttons from: https://github.com/maydemirx/leaflet-tag-filter-button-->
  <link rel="stylesheet" href="src/leaflet-tag-filter-button.css">
  <link rel="stylesheet" href="src/easy-button.css">

  <style type="text/css">
    h1 {
      font-size: 30px;
      font-family: 'Rubik', sans-serif;
      display: inline-block;
      color: white;
      margin-left: 18px;
      margin-right: 30px;
      padding-top: 20px;
      padding-bottom: 10px;
    }

    h2 {
      font-size: 14px;
      font-family: 'Rubik', sans-serif;
      padding-bottom: 0px;
    }

    h3 {
      font-size: 5px;
      font-family: 'Rubik', sans-serif;
      padding-top: 0px;
    }

    h4 {
      font-size: 14px;
      font-family: 'Rubik', sans-serif;
      display: inline-block;
      margin-right: 16px;
      margin-left: 19px;
      padding-bottom: 1px;
      color: white;
    }

    body {
      margin: 0px;
      height: 100%;
      width: 100%;
    }

    /* Add banner to header background */
    header {
      background-image: url('images/Iowa_Prairie.jpg');
      position: fixed;
      width: 100%;
      height: 100px;
      background-color: #000000;
      box-shadow: 0px 5px 5px black;
      z-index: 800;
    }

    /* Set map parameters */
    #map {
      position: fixed;
      top: 100px;
      bottom: 0px;
      width: 100%;
    }

    .legend {
      background-color: #fff;
      border-radius: 3px;
      bottom: 30px;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.10);
      font: 12px/20px 'Rubik', 'Rubik', 'Rubik', sans-serif;
      padding: 10px;
      position: absolute;
      right: 10px;
      z-index: 1;
      line-height: 18px;
      color: #555;
    }

    .legend i {
      width: 50px;
      height: 18px;
      float: left;
      margin-right: 25px;
      opacity: 0.7;
    }

    .leaflet-control-layers-expanded {
      font-family: 'Rubik', sans-serif;
    }

    .easy-button-button {
      display: block !important;
    }

    .tag-filter-tags-container {
      left: 30px;
    }
  </style>
</head>

<body>
  <header>
    <h1>Iowa Rural Justice Project: Attorneys by Zip Code</h1><br>
    <h4>Map by Jay Bowen, University of Iowa Digital Scholarship & Publishing Studio</a></h4>
  </header>
  <div id="map"></div>

  <!-- load scripts -->
  <script src='https://api.mapbox.com/mapbox-assembly/v0.8.0/assembly.js'></script>
  <script src='https://api.mapbox.com/mapbox.js/v3.2.1/mapbox.js'></script>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-sparklines/2.1.2/jquery.sparkline.min.js"></script>

  <script src="src/easy-button.js"></script>
  <script src="src/leaflet-tag-filter-button.js"></script>

  <script type="text/javascript">
    // Initialize the map
    var map = L.map('map').setView([42.05, -93.5], 8);

    // Load a tile layer
    L.tileLayer('https://tile.thunderforest.com/neighbourhood/{z}/{x}/{y}.png?apikey=dd2dca516d114fd89c0b1403358cbfa8', {
      attribution: '&copy; <a href="http://www.thunderforest.com/">Thunderforest</a>, &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
      apikey: '<dd2dca516d114fd89c0b1403358cbfa8>',
      maxZoom: 18,
      minZoom: 6,
    }).addTo(map);

    // add a scale bar
    L.control.scale().addTo(map); // Initialize the map

    // Add a function to style the zip codes by their attorney counts (jenks)
    function getColor(d) {
      return d > 422.00 ? '#8c2d04' :
        d > 161.00 ? '#cc4c02' :
        d > 83.00 ? '#ec7014' :
        d > 47.00 ? '#fe9929' :
        d > 24.00 ? '#fec44f' :
        d > 9.00 ? '#fee391' :
        d > 0.00 ? '#ffffd4' :
        '#1C00ff00';
    };

    // Add a function to style the zip codes by attorneys per thousand people (jenks)
    function getShade(d) {
      return d > 129.88 ? '#0c2c84' :
        d > 78.80 ? '#225ea8' :
        d > 13.70 ? '#1d91c0' :
        d > 6.38 ? '#41b6c4' :
        d > 1.98 ? '#7fcdbb' :
        d > 0.62 ? '#c7e9b4' :
        d > 0.01 ? '#ffffcc' :
        '#1C00ff00';
    };

    // load the data asynchronously
    // zip codes polygon from: https://www.arcgis.com/home/item.html?id=8d2012a2016e484dafaac0451f9aea24
    d3.queue()
      .defer(d3.json, 'data/Attys_by_Zip.geojson')
      .await(drawMap); // load the data asynchronously

    // define drawMap function
    function drawMap(err, zips) {

      var zipCodes = L.geoJson(zips, {

        // style the layer
        style: function(feature) {

          var tags = [];

          tags.push(feature.properties.PO_NAME);
          tags.push(feature.properties.ZIP_CODE);

          return {
            stroke: 0.5,
            color: 'grey',
            strokeOpacity: 0.75,
            weight: 0.5,
            fillColor: getColor(feature.properties.Count),
            fillOpacity: 0.75,
            tags: tags //define the tags with the tags array
          };
        },

        onEachFeature: function(feature, layer) {
          // bind a popup window
          layer.bindPopup('<h2><b>Zip Code: ' + feature.properties.Zip + '<br>' + 'Community: ' + feature.properties.PO_NAME + '<br>' + 'Attorneys: ' + feature.properties.Count + '</b></h2>' + feature.properties.popup, {
            maxHeight: 300,
            minWidth: 250,
            maxWidth: 300,
          });
          // change layer style on mouseover
          layer.on("mouseover", function(e) {
            layer.setStyle({
              color: '#3232FF',
              weight: 3,
              opacity: 0.5
            });
          });
          // reset style on mouseout
          layer.on("mouseout", function(e) {
            zipCodes.resetStyle(e.target);
          });

        }

      }).addTo(map); // add the layer to the map

      var attysThds = L.geoJson(zips, {

        // style the layer
        style: function(feature) {

          var tags = [];

          tags.push(feature.properties.PO_NAME);
          tags.push(feature.properties.ZIP_CODE);

          return {
            stroke: 0.5,
            color: 'grey',
            strokeOpacity: 0.75,
            weight: 0.5,
            fillColor: getShade(feature.properties.Attys_perThousand),
            fillOpacity: 0.75,
            tags: tags //define the tags with the tags array
          };
        },

        onEachFeature: function(feature, layer) {
          // bind a popup window
          layer.bindPopup('<h2><b>Zip Code: ' + feature.properties.Zip + '<br>' + 'Community: ' + feature.properties.PO_NAME + '<br>' + 'Attorneys/1000 People: ' + feature.properties.Attys_perThousand + '</b></h2>' + feature.properties.popup, {
            maxHeight: 300,
            minWidth: 250,
            maxWidth: 300,
          });
          // change layer style on mouseover
          layer.on("mouseover", function(e) {
            layer.setStyle({
              color: '#3232FF',
              weight: 3,
              opacity: 0.5
            });
          });
          // reset style on mouseout
          layer.on("mouseout", function(e) {
            attysThds.resetStyle(e.target);
          });

        }

      });

      // dynamically fit the map to the zip codes polygon
      map.fitBounds(zipCodes.getBounds());

      // designate the layers as baselayers (allows only one open at a time)
      var baselayers = {
        "Attorneys by Zip Code": zipCodes,
        "Attorneys per 1,000 People": attysThds
      };

      // all done with the layers, add them to layer control
      L.control.layers(baselayers, null, {
        collapsed: false,
      }).addTo(map);

      // create legends for both layers
      var zipLegend = L.control({
        position: 'bottomright'
      });

      var thdsLegend = L.control({
        position: 'bottomright'
      });

      //add filter button for:
      //communities
      L.control.tagFilterButton({
        data: ['Ackley', 'Ackworth', 'Adair', 'Adel', 'Afton', 'Agency', 'Ainsworth', 'Akron', 'Albert City', 'Albia', 'Albion', 'Alburnett', 'Alden', 'Alexander', 'Algona', 'Alleman', 'Allerton', 'Allison', 'Alta', 'Alta Vista', 'Alton', 'Altoona', 'Alvord', 'Amana', 'Ames', 'Anamosa', 'Anita', 'Ankeny', 'Anthon', 'Aplington', 'Arcadia', 'Archer', 'Aredale', 'Argyle', 'Arion', 'Arlington', 'Armstrong', 'Arnolds Park', 'Arthur', 'Ashton', 'Aspinwall', 'Atalissa', 'Atkins', 'Atlantic', 'Auburn', 'Audubon', 'Aurelia', 'Aurora', 'Austinville', 'Avoca', 'Ayrshire', 'Badger', 'Bagley', 'Baldwin', 'Bancroft', 'Barnes City', 'Barnum', 'Batavia', 'Battle Creek', 'Baxter', 'Bayard', 'Beacon', 'Beaman', 'Beaver', 'Bedford', 'Belle Plaine', 'Bellevue', 'Belmond', 'Bennett', 'Benton', 'Bernard', 'Berwick', 'Bettendorf', 'Bevington', 'Birmingham', 'Blairsburg', 'Blairstown', 'Blakesburg', 'Blanchard', 'Blencoe', 'Blockton', 'Bloomfield', 'Blue Grass', 'Bode', 'Bonaparte', 'Bondurant', 'Boone', 'Booneville', 'Bouton', 'Boxholm', 'Boyden', 'Braddyville', 'Bradford', 'Bradgate', 'Brandon', 'Brayton', 'Breda', 'Bridgewater', 'Brighton', 'Bristow', 'Britt', 'Bronson', 'Brooklyn', 'Bryant', 'Buckingham', 'Buffalo', 'Buffalo Center', 'Burlington', 'Burt', 'Bussey', 'Calamus', 'Callender', 'Calmar', 'Calumet', 'Camanche', 'Cambridge', 'Cantril', 'Carbon', 'Carlisle', 'Carpenter', 'Carroll', 'Carson', 'Carter Lake', 'Cascade', 'Casey', 'Castalia', 'Castana', 'Cedar', 'Cedar Falls', 'Cedar Rapids', 'Center Junction', 'Center Point', 'Centerville', 'Central City', 'Chariton', 'Charles City', 'Charlotte', 'Charter Oak', 'Chatsworth', 'Chelsea', 'Cherokee', 'Chester', 'Chillicothe', 'Churdan', 'Cincinnati', 'Clare', 'Clarence', 'Clarinda', 'Clarion', 'Clarksville', 'Clear Lake', 'Clearfield', 'Cleghorn', 'Clemons', 'Clermont', 'Clinton', 'Clio', 'Clive', 'Clutier', 'Coggon', 'Coin', 'Colesburg', 'Colfax', 'College Springs', 'Collins', 'Colo', 'Columbia', 'Columbus City', 'Columbus Junction', 'Colwell', 'Conesville', 'Conrad', 'Conroy', 'Coon Rapids', 'Cooper', 'Coralville', 'Corning', 'Correctionville', 'Corwith', 'Corydon', 'Council Bluffs', 'Crawfordsville', 'Crescent', 'Cresco', 'Creston', 'Cromwell', 'Crystal Lake', 'Cumberland', 'Cumming', 'Curlew', 'Cushing', 'Cylinder', 'Dakota City', 'Dallas Center', 'Dana', 'Danbury', 'Danville', 'Davenport', 'Davis City', 'Dawson', 'Dayton', 'De Soto', 'De Witt', 'Decatur', 'Decorah', 'Dedham', 'Deep River', 'Defiance', 'Delaware', 'Delhi', 'Delmar', 'Deloit', 'Delta', 'Denison', 'Denmark', 'Denver', 'Derby', 'Des Moines', 'Dewar', 'Dexter', 'Diagonal', 'Dickens', 'Dike', 'Dixon', 'Dolliver', 'Donahue', 'Donnellson', 'Doon', 'Dorchester', 'Douds', 'Dougherty', 'Dow City', 'Dows', 'Drakesville', 'Dubuque', 'Dumont', 'Duncombe', 'Dundee', 'Dunkerton', 'Dunlap', 'Durango', 'Durant', 'Dyersville', 'Dysart', 'Eagle Grove', 'Earlham', 'Earling', 'Earlville', 'Early', 'Eddyville', 'Edgewood', 'Elberon', 'Eldon', 'Eldora', 'Eldridge', 'Elgin', 'Elk Horn', 'Elkader', 'Elkhart', 'Elkport', 'Elliott', 'Ellston', 'Ellsworth', 'Elma', 'Ely', 'Emerson', 'Emmetsburg', 'Epworth', 'Essex', 'Estherville', 'Evansdale', 'Everly', 'Exira', 'Exline', 'Fairbank', 'Fairfax', 'Fairfield', 'Farley', 'Farmersburg', 'Farmington', 'Farnhamville', 'Farragut', 'Fayette', 'Fenton', 'Fertile', 'Floris', 'Floyd', 'Fonda', 'Fontanelle', 'Forest City', 'Fort Atkinson', 'Fort Dodge', 'Fort Madison', 'Fredericksburg', 'Fremont', 'Fruitland', 'Galt', 'Galva', 'Garber', 'Garden Grove', 'Garnavillo', 'Garner', 'Garrison', 'Garwin', 'Geneva', 'George', 'Gibson', 'Gilbert', 'Gilbertville', 'Gilman', 'Gilmore City', 'Gladbrook', 'Glenwood', 'Glidden', 'Goldfield', 'Goodell', 'Goose Lake', 'Gowrie', 'Graettinger', 'Grafton', 'Grand Junction', 'Grand Mound', 'Grand River', 'Granger', 'Grant', 'Granville', 'Gravity', 'Gray', 'Greeley', 'Greene', 'Greenfield', 'Greenville', 'Grimes', 'Grinnell', 'Griswold', 'Grundy Center', 'Guernsey', 'Guthrie Center', 'Guttenberg', 'Halbur', 'Hamburg', 'Hamilton', 'Hamlin', 'Hampton', 'Hancock', 'Hanlontown', 'Harcourt', 'Hardy', 'Harlan', 'Harper', 'Harpers Ferry', 'Harris', 'Hartford', 'Hartley', 'Hartwick', 'Harvey', 'Hastings', 'Havelock', 'Haverhill', 'Hawarden', 'Hawkeye', 'Hazleton', 'Hedrick', 'Henderson', 'Hiawatha', 'Hills', 'Hillsboro', 'Hinton', 'Holland', 'Holstein', 'Holy Cross', 'Homestead', 'Honey Creek', 'Hopkinton', 'Hornick', 'Hospers', 'Hubbard', 'Hudson', 'Hull', 'Humboldt', 'Humeston', 'Huxley', 'Ida Grove', 'Imogene', 'Independence', 'Indianola', 'Inwood', 'Ionia', 'Iowa City', 'Iowa Falls', 'Ira', 'Ireton', 'Irwin', 'Jamaica', 'Janesville', 'Jefferson', 'Jesup', 'Jewell', 'Johnston', 'Joice', 'Jolley', 'Kalona', 'Kamrar', 'Kanawha', 'Kellerton', 'Kelley', 'Kellogg', 'Kensett', 'Keokuk', 'Keosauqua', 'Keota', 'Kesley', 'Keswick', 'Keystone', 'Kimballton', 'Kingsley', 'Kirkman', 'Kirkville', 'Kiron', 'Klemme', 'Knoxville', 'La Motte', 'La Porte City', 'Lacona', 'Ladora', 'Lake City', 'Lake Mills', 'Lake Park', 'Lake View', 'Lakota', 'Lamoni', 'Lamont', 'Langworthy', 'Lansing', 'Larchwood', 'Larrabee', 'Latimer', 'Laurel', 'Laurens', 'Lawler', 'Lawton', 'Le Claire', 'Le Grand', 'Le Mars', 'Ledyard', 'Lehigh', 'Leighton', 'Leland', 'Lenox', 'Leon', 'Lester', 'Letts', 'Lewis', 'Libertyville', 'Lime Springs', 'Linden', 'Lineville', 'Linn Grove', 'Lisbon', 'Liscomb', 'Little Cedar', 'Little Rock', 'Little Sioux', 'Livermore', 'Lockridge', 'Logan', 'Lohrville', 'Lone Rock', 'Lone Tree', 'Long Grove', 'Lorimor', 'Lost Nation', 'Lovilia', 'Lowden', 'Lu Verne', 'Luana', 'Lucas', 'Luther', 'Luzerne', 'Lynnville', 'Lytton', 'Macedonia', 'Macksburg', 'Madrid', 'Magnolia', 'Malcom', 'Mallard', 'Malvern', 'Manchester', 'Manilla', 'Manly', 'Manning', 'Manson', 'Mapleton', 'Maquoketa', 'Marathon', 'Marble Rock', 'Marcus', 'Marengo', 'Marion', 'Marne', 'Marquette', 'Marshalltown', 'Martelle', 'Martensdale', 'Mason City', 'Masonville', 'Massena', 'Matlock', 'Maurice', 'Maxwell', 'Maynard', 'Mc Callsburg', 'Mc Causland', 'Mc Clelland', 'Mc Gregor', 'Mc Intire', 'Mechanicsville', 'Mediapolis', 'Melbourne', 'Melcher Dallas', 'Melrose', 'Melvin', 'Menlo', 'Meriden', 'Merrill', 'Meservey', 'Middle Amana', 'Middletown', 'Miles', 'Milford', 'Millerton', 'Milo', 'Milton', 'Minburn', 'Minden', 'Mineola', 'Mingo', 'Missouri Valley', 'Mitchellville', 'Modale', 'Mondamin', 'Monmouth', 'Monona', 'Monroe', 'Montezuma', 'Monticello', 'Montour', 'Montpelier', 'Montrose', 'Moorhead', 'Moorland', 'Moravia', 'Morley', 'Morning Sun', 'Morrison', 'Moscow', 'Moulton', 'Mount Auburn', 'Mount Ayr', 'Mount Pleasant', 'Mount Sterling', 'Mount Union', 'Mount Vernon', 'Moville', 'Murray', 'Muscatine', 'Mystic', 'Nashua', 'Nemaha', 'Neola', 'Nevada', 'New Albin', 'New Hampton', 'New Hartford', 'New Liberty', 'New London', 'New Market', 'New Providence', 'New Sharon', 'New Vienna', 'New Virginia', 'Newell', 'Newhall', 'Newton', 'Nichols', 'Nodaway', 'Nora Springs', 'North Buena Vista', 'North English', 'North Liberty', 'Northboro', 'Northwood', 'Norwalk', 'Norway', 'Oakland', 'Oakville', 'Ocheyedan', 'Odebolt', 'Oelwein', 'Ogden', 'Okoboji', 'Olin', 'Ollie', 'Omaha', 'Onawa', 'Onslow', 'Oran', 'Orange City', 'Orchard', 'Orient', 'Osage', 'Osceola', 'Oskaloosa', 'Ossian', 'Otho', 'Otley', 'Oto', 'Ottosen', 'Ottumwa', 'Oxford', 'Oxford Junction', 'Pacific Junction', 'Packwood', 'Palmer', 'Palo', 'Panama', 'Panora', 'Parkersburg', 'Parnell', 'Paton', 'Patterson', 'Paullina', 'Pella', 'Peosta', 'Percival', 'Perry', 'Persia', 'Peru', 'Peterson', 'Pierson', 'Pilot Mound', 'Pisgah', 'Plainfield', 'Plano', 'Pleasant Hill', 'Pleasantville', 'Plymouth', 'Pocahontas', 'Polk City', 'Pomeroy', 'Popejoy', 'Portsmouth', 'Postville', 'Prairie City', 'Prairieburg', 'Prescott', 'Preston', 'Primghar', 'Princeton', 'Prole', 'Promise City', 'Protivin', 'Pulaski', 'Quasqueton', 'Quimby', 'Radcliffe', 'Randalia', 'Randall', 'Randolph', 'Raymond', 'Readlyn', 'Reasnor', 'Red Oak', 'Redding', 'Redfield', 'Reinbeck', 'Rembrandt', 'Remsen', 'Renwick', 'Rhodes', 'Riceville', 'Richland', 'Ridgeway', 'Ringsted', 'Rippey', 'Riverside', 'Riverton', 'Robins', 'Rock Falls', 'Rock Rapids', 'Rock Valley', 'Rockford', 'Rockwell', 'Rockwell City', 'Rodney', 'Roland', 'Rolfe', 'Rose Hill', 'Rowan', 'Rowley', 'Royal', 'Rudd', 'Runnells', 'Russell', 'Ruthven', 'Rutland', 'Ryan', 'Sabula', 'Sac City', 'Saint Ansgar', 'Saint Anthony', 'Saint Charles', 'Saint Marys', 'Saint Olaf', 'Saint Paul', 'Salem', 'Salix', 'Sanborn', 'Scarville', 'Schaller', 'Schleswig', 'Scranton', 'Searsboro', 'Selma', 'Sergeant Bluff', 'Seymour', 'Shannon City', 'Sharpsburg', 'Sheffield', 'Shelby', 'Sheldahl', 'Sheldon', 'Shell Rock', 'Shellsburg', 'Shenandoah', 'Sherrill', 'Sibley', 'Sidney', 'Sigourney', 'Silver City', 'Sioux Center', 'Sioux City', 'Sioux Rapids', 'Slater', 'Sloan', 'Smithland', 'Soldier', 'Solon', 'Somers', 'South Amana', 'South English', 'Spencer', 'Sperry', 'Spirit Lake', 'Spragueville', 'Springville', 'Stacyville', 'Stanhope', 'Stanley', 'Stanton', 'Stanwood', 'State Center', 'Steamboat Rock', 'Stockport', 'Stockton', 'Storm Lake', 'Story City', 'Stratford', 'Strawberry Point', 'Stuart', 'Sully', 'Sumner', 'Superior', 'Sutherland', 'Swaledale', 'Swan', 'Swea City', 'Swisher', 'Tabor', 'Tama', 'Templeton', 'Terril', 'Thayer', 'Thompson', 'Thor', 'Thornton', 'Thurman', 'Tiffin', 'Tingley', 'Tipton', 'Titonka', 'Toddville', 'Toeterville', 'Toledo', 'Tracy', 'Traer', 'Treynor', 'Tripoli', 'Truro', 'Udell', 'Underwood', 'Union', 'Unionville', 'Urbana', 'Urbandale', 'Ute', 'Vail', 'Van Horne', 'Van Meter', 'Van Wert', 'Ventura', 'Victor', 'Villisca', 'Vincent', 'Vining', 'Vinton', 'Volga', 'Wadena', 'Walcott', 'Walford', 'Walker', 'Wall Lake', 'Wallingford', 'Walnut', 'Wapello', 'Washington', 'Washta', 'Waterloo', 'Waterville', 'Watkins', 'Waucoma', 'Waukee', 'Waukon', 'Waverly', 'Wayland', 'Webb', 'Webster', 'Webster City', 'Weldon', 'Wellman', 'Wellsburg', 'Wesley', 'West Bend', 'West Branch', 'West Burlington', 'West Chester', 'West des Moines', 'West Liberty', 'West Point', 'West Union', 'Westfield', 'Westgate', 'Westphalia', 'Westside', 'Wever', 'What Cheer', 'Wheatland', 'Whiting', 'Whittemore', 'Whitten', 'Williams', 'Williamsburg', 'Williamson', 'Wilton', 'Windsor Heights', 'Winfield', 'Winterset', 'Winthrop', 'Wiota', 'Woden', 'Woodbine', 'Woodburn', 'Woodward', 'Woolstock', 'Worthington', 'Wyoming', 'Yale', 'Yarmouth', 'Yorktown', 'Zearing', 'Zwingle'],
        filterOnEveryClick: true,
        icon: '<i class="fas fa-map-marked-alt"></i>',
      }).addTo(map);

      //add filter button for:
      //zip codes
      L.control.tagFilterButton({
        data: ['50001', '50002', '50003', '50005', '50006', '50007', '50008', '50009', '50010', '50011', '50012', '50013', '50014', '50020', '50021', '50022', '50023', '50025', '50026', '50027', '50028', '50029', '50031', '50032', '50033', '50034', '50035', '50036', '50038', '50039', '50040', '50041', '50042', '50044', '50046', '50047', '50048', '50049', '50050', '50051', '50052', '50054', '50055', '50056', '50057', '50058', '50059', '50060', '50061', '50062', '50063', '50064', '50065', '50066', '50067', '50068', '50069', '50070', '50071', '50072', '50073', '50074', '50075', '50076', '50101', '50103', '50104', '50105', '50106', '50107', '50108', '50109', '50110', '50111', '50112', '50115', '50116', '50117', '50118', '50119', '50120', '50122', '50123', '50124', '50125', '50126', '50127', '50128', '50129', '50130', '50131', '50132', '50133', '50134', '50135', '50136', '50138', '50139', '50140', '50141', '50142', '50143', '50144', '50146', '50147', '50148', '50149', '50150', '50151', '50152', '50153', '50154', '50155', '50156', '50157', '50158', '50160', '50161', '50162', '50163', '50164', '50165', '50166', '50167', '50168', '50169', '50170', '50171', '50173', '50174', '50201', '50206', '50207', '50208', '50210', '50211', '50212', '50213', '50214', '50216', '50217', '50218', '50219', '50220', '50222', '50223', '50225', '50226', '50227', '50228', '50229', '50230', '50231', '50232', '50233', '50234', '50235', '50236', '50237', '50238', '50239', '50240', '50241', '50242', '50243', '50244', '50246', '50247', '50248', '50249', '50250', '50251', '50252', '50254', '50256', '50257', '50258', '50261', '50262', '50263', '50264', '50265', '50266', '50268', '50269', '50271', '50272', '50273', '50274', '50275', '50276', '50277', '50278', '50309', '50310', '50311', '50312', '50313', '50314', '50315', '50316', '50317', '50319', '50320', '50321', '50322', '50323', '50324', '50325', '50327', '50401', '50420', '50421', '50423', '50424', '50426', '50428', '50430', '50432', '50433', '50434', '50435', '50436', '50438', '50439', '50440', '50441', '50444', '50446', '50447', '50448', '50449', '50450', '50451', '50452', '50453', '50454', '50455', '50456', '50457', '50458', '50459', '50460', '50461', '50464', '50466', '50467', '50468', '50469', '50470', '50471', '50472', '50473', '50475', '50476', '50477', '50478', '50479', '50480', '50481', '50482', '50483', '50484', '50501', '50510', '50511', '50514', '50515', '50516', '50517', '50518', '50519', '50520', '50522', '50523', '50524', '50525', '50527', '50528', '50529', '50530', '50531', '50532', '50533', '50535', '50536', '50538', '50539', '50540', '50541', '50542', '50543', '50544', '50545', '50546', '50548', '50551', '50554', '50556', '50557', '50558', '50559', '50560', '50561', '50562', '50563', '50565', '50566', '50567', '50568', '50569', '50570', '50571', '50574', '50575', '50576', '50577', '50578', '50579', '50581', '50582', '50583', '50585', '50586', '50588', '50590', '50591', '50594', '50595', '50597', '50598', '50599', '50601', '50602', '50603', '50604', '50605', '50606', '50607', '50608', '50609', '50611', '50612', '50613', '50614', '50616', '50619', '50620', '50621', '50622', '50623', '50624', '50625', '50626', '50627', '50628', '50629', '50630', '50632', '50633', '50634', '50635', '50636', '50638', '50641', '50642', '50643', '50644', '50645', '50647', '50648', '50649', '50650', '50651', '50653', '50654', '50655', '50657', '50658', '50659', '50660', '50662', '50664', '50665', '50666', '50667', '50668', '50669', '50670', '50671', '50672', '50674', '50675', '50676', '50677', '50680', '50681', '50682', '50701', '50702', '50703', '50707', '50801', '50830', '50833', '50835', '50836', '50837', '50839', '50840', '50841', '50842', '50843', '50845', '50846', '50847', '50848', '50849', '50851', '50853', '50854', '50857', '50858', '50859', '50860', '50861', '50862', '50863', '50864', '51001', '51002', '51003', '51004', '51005', '51006', '51007', '51009', '51010', '51011', '51012', '51014', '51016', '51018', '51019', '51020', '51022', '51023', '51024', '51025', '51026', '51027', '51028', '51029', '51030', '51031', '51033', '51034', '51035', '51036', '51037', '51038', '51039', '51040', '51041', '51044', '51046', '51047', '51048', '51049', '51050', '51051', '51052', '51053', '51054', '51055', '51056', '51058', '51060', '51061', '51062', '51063', '51101', '51103', '51104', '51105', '51106', '51108', '51109', '51111', '51201', '51230', '51231', '51232', '51234', '51235', '51237', '51238', '51239', '51240', '51241', '51242', '51243', '51244', '51245', '51246', '51247', '51248', '51249', '51250', '51301', '51331', '51333', '51334', '51338', '51342', '51343', '51345', '51346', '51347', '51350', '51351', '51354', '51355', '51357', '51358', '51360', '51363', '51364', '51365', '51366', '51401', '51430', '51431', '51432', '51433', '51436', '51439', '51440', '51441', '51442', '51443', '51444', '51445', '51446', '51447', '51448', '51449', '51450', '51453', '51454', '51455', '51458', '51461', '51462', '51463', '51465', '51466', '51467', '51501', '51503', '51510', '51520', '51521', '51523', '51525', '51526', '51527', '51528', '51529', '51530', '51531', '51532', '51533', '51534', '51535', '51536', '51537', '51540', '51541', '51542', '51543', '51544', '51545', '51546', '51548', '51549', '51550', '51551', '51552', '51553', '51554', '51555', '51556', '51557', '51558', '51559', '51560', '51561', '51562', '51563', '51564', '51565', '51566', '51570', '51571', '51572', '51573', '51575', '51576', '51577', '51578', '51579', '51601', '51630', '51631', '51632', '51636', '51637', '51638', '51639', '51640', '51645', '51646', '51647', '51648', '51649', '51650', '51652', '51653', '51654', '51656', '52001', '52002', '52003', '52031', '52032', '52033', '52035', '52036', '52037', '52038', '52039', '52040', '52041', '52042', '52043', '52044', '52045', '52046', '52047', '52048', '52049', '52050', '52052', '52053', '52054', '52057', '52060', '52064', '52065', '52066', '52068', '52069', '52070', '52072', '52073', '52074', '52076', '52077', '52078', '52079', '52101', '52132', '52133', '52134', '52135', '52136', '52140', '52141', '52142', '52144', '52146', '52147', '52151', '52154', '52155', '52156', '52157', '52158', '52159', '52160', '52161', '52162', '52163', '52164', '52165', '52169', '52170', '52171', '52172', '52175', '52201', '52202', '52203', '52205', '52206', '52207', '52208', '52209', '52210', '52211', '52212', '52213', '52214', '52215', '52216', '52217', '52218', '52219', '52220', '52221', '52222', '52223', '52224', '52225', '52227', '52228', '52229', '52231', '52232', '52233', '52235', '52236', '52237', '52240', '52241', '52242', '52245', '52246', '52247', '52248', '52249', '52251', '52252', '52253', '52254', '52255', '52257', '52301', '52302', '52305', '52306', '52307', '52309', '52310', '52312', '52313', '52314', '52315', '52316', '52317', '52318', '52320', '52321', '52322', '52323', '52324', '52325', '52326', '52327', '52328', '52329', '52330', '52332', '52333', '52334', '52335', '52336', '52337', '52338', '52339', '52340', '52341', '52342', '52345', '52346', '52347', '52348', '52349', '52351', '52352', '52353', '52354', '52355', '52356', '52358', '52359', '52361', '52362', '52401', '52402', '52403', '52404', '52405', '52411', '52501', '52530', '52531', '52533', '52534', '52535', '52536', '52537', '52540', '52542', '52543', '52544', '52548', '52549', '52550', '52551', '52552', '52553', '52554', '52555', '52556', '52560', '52561', '52563', '52565', '52566', '52567', '52569', '52570', '52571', '52572', '52573', '52574', '52576', '52577', '52580', '52581', '52583', '52584', '52585', '52586', '52588', '52590', '52591', '52593', '52594', '52601', '52619', '52620', '52621', '52623', '52624', '52625', '52626', '52627', '52630', '52632', '52635', '52637', '52638', '52639', '52640', '52641', '52644', '52645', '52646', '52649', '52650', '52651', '52653', '52654', '52655', '52656', '52657', '52658', '52659', '52660', '52720', '52721', '52722', '52726', '52727', '52728', '52729', '52730', '52731', '52732', '52737', '52738', '52739', '52742', '52745', '52746', '52747', '52748', '52749', '52750', '52751', '52753', '52754', '52755', '52756', '52758', '52759', '52760', '52761', '52765', '52766', '52768', '52769', '52772', '52773', '52776', '52777', '52778', '52801', '52802', '52803', '52804', '52806', '52807', '68110'],
        filterOnEveryClick: true,
        icon: '<i class="far fa-envelope"></i>',
      }).addTo(map);

      jQuery('.easy-button-button').click(function() {
        target = jQuery('.easy-button-button').not(this);
        target.parent().find('.tag-filter-tags-container').css({
          'display': 'none',
        });
      });

      //disable dragging of the map after clicking a filter button
      jQuery('.easy-button-button').click(function() {
        map.dragging.disable();
      });

      //enable dragging of the map after clicking on the map
      map.on('click', function() {
        map.dragging.enable();
      });

      // add content to the legend
      zipLegend.onAdd = function(map) {

        var div = L.DomUtil.create('div', 'info legend'),
          grades = [1.00, 9.00, 24.00, 47.00, 83.00, 161.00, 422.00],
          labels = ["<h6 style='font-size:14px; font-weight:bold'>Attorneys by Zip Code</h6>"];

        // loop through our density intervals and generate a label with a colored square for each interval
        for (var i = 0; i < grades.length; i++) {
          div.innerHTML +=
            labels.push('<i style="background:' + getColor(grades[i] + 1) + '"></i> ' +
              grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] : '+'));
        }
        div.innerHTML = labels.join('<br>');
        return div;
      };

      // add content to the legend
      thdsLegend.onAdd = function(map) {

        var div = L.DomUtil.create('div', 'info legend'),
          grades = [0.01, 0.62, 1.98, 6.38, 13.70, 78.80, 129.88],
          labels = ["<h6 style='font-size:14px; font-weight:bold'>Attorneys per 1,000 People</h6>"];

        // loop through our density intervals and generate a label with a colored square for each interval
        for (var i = 0; i < grades.length; i++) {
          div.innerHTML +=
            labels.push('<i style="background:' + getShade(grades[i] + 0.01) + '"></i> ' +
              grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] : '+'));
        }
        div.innerHTML = labels.join('<br>');
        return div;
      };

      // add this legend to the map, because this legend is on by default
      zipLegend.addTo(map);

      // when the user changes the baselayer, switch the legend
      map.on('baselayerchange', function(eventLayer) {
        // Switch to the Attorneys by Zip Code legend...
        if (eventLayer.name === 'Attorneys by Zip Code') {
          this.removeControl(thdsLegend);
          zipLegend.addTo(this);
        } else { // Or switch to the Attorneys per 1,000 People legend...
          this.removeControl(zipLegend);
          thdsLegend.addTo(this);
        }
      });

    }; // end drawMap function
  </script>
</body>

</html>
